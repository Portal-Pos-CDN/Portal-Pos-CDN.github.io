/*!
 * DESKTOP-G9RC0RK - 23/10/2020, 15:35:55 - (-03:00)
 * Não edite esse arquivo, ele foi gerado de maneira automatizada
 */
!function(e){var t={};function a(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(r,o,function(t){return e[t]}.bind(null,o));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=532)}({532:function(e,t,a){e.exports=a(533)},533:function(e,t,a){"use strict";a(534),$((function(){$("body.body-checkout-confirmation #app-top, body.body-checkout-confirmation #app-container").hide(),window.storeConfig={accountName:"portalposqa",kosmos:{url:"//kroton.stage.platosedu.io/rest/api",access:'{"conta":"kosmos.integracao","senha":"APlaceFullOfPossibilities"}'},middleware:{url:"//krotonposqa.ymi.com.br/api/v1"}};var e={getDatalayer:function(){var e=[];return dataLayer.forEach((function(t){"orderPlaced"==t.event&&(e=t)})),e},getTransactionId:function(){var e=this.getDatalayer().transactionId.trim();return~e.indexOf("-")||(e+="-01"),e},getDateString:function(){var e=this.getDatalayer().transactionDate.split("T")[0];return(e=e.split("-"))[2]+"/"+e[1]+"/"+e[0]},getPriceString:function(){var e=this.getDatalayer();if(e.transactionPaymentType.length)var t=e.transactionPaymentType[0].value,a="R$ "+this.formatPrice(t/100,2,",",".");else a="R$ 0,00";return a},getPaymentMethod:function(){var e=this.getDatalayer();return e.transactionPaymentType.length?e.transactionPaymentType[0].paymentSystemName:"Voucher"},formatPrice:function(e,t,a,r){e=(e+"").replace(",","").replace(" ","");var o=isFinite(+e)?+e:0,n=isFinite(+t)?Math.abs(t):0,i=void 0===r?",":r,c=void 0===a?".":a,d="";return(d=(n?function(e,t){var a=Math.pow(10,t);return""+Math.round(e*a)/a}(o,n):""+Math.round(o)).split("."))[0].length>3&&(d[0]=d[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(d[1]||"").length<n&&(d[1]=d[1]||"",d[1]+=new Array(n-d[1].length+1).join("0")),d.join(c)}},t=function(){return localStorage.getItem("orderData")?JSON.parse(localStorage.getItem("orderData")):{}},a=function(e,t){var a=JSON.parse(localStorage.getItem("orderData"))||{};a[e]=t,localStorage.setItem("orderData",JSON.stringify(a))},r=setInterval((function(){if(void 0!==dataLayer){var o=e.getDatalayer();o&&o.event&&(clearInterval(r),console.log("waiting dataLayer orderPLaced..."),function(){a("orderId",e.getTransactionId()),a("formadepagamento",e.getPaymentMethod()),a("dataPedido",e.getDateString()),a("totalPedido",e.getPriceString());var r=t();if(r.isEbook)return void(window.location="/pedido-confirmado-ebook");var o=null,n={orderId:r.orderId,json:{orderId:r.orderId,consultorId:"-"===r.consultor?"":r.consultor,voucher:"-"===r.voucher.codigo?"":r.voucher.codigo},erroAjax:!1,requestTime:0};dataLayer.push({integracaoEventAction:"iniciando-envio"}),dataLayer.push({event:"gaSendIntegracao"});var i=(new Date).getTime();function c(e,a){a&&(e.erroAjax=a),$.ajax({url:window.storeConfig.middleware.url+"/0_matricula",type:"POST",data:JSON.stringify(e)}).always((function(){!function(e){var a=t();$.ajax({url:"/api/dataentities/EM/documents?an="+window.storeConfig.accountName,type:"POST",dataType:"json",headers:{accept:"application/json","content-type":"application/json"},data:JSON.stringify({orderId:r.orderId,json:JSON.stringify(e),orderData:a,retornoMiddleware:JSON.stringify(o)}),error:function(e,t){console.log("Error envio EM")}}).always((function(){dataLayer.push({integracaoEventAction:"redirect-contrato"}),dataLayer.push({event:"gaSendIntegracao"}),r.payment.iugu&&!e.erroAjax?window.location="/pagamento/?pedido="+r.orderId:window.location="/inscricao/pedidoConfirmado"}))}(e)}))}a("contratoConfirmado",!1),$.ajax({url:window.storeConfig.middleware.url+"/1_matricula",type:"POST",data:JSON.stringify(n.json),success:function(e){n.requestTime=(new Date).getTime()-i,o=e;var t="";null!=e.data?(e.data.message&&(a("errKosmos",!0),t=e.data.message,dataLayer.push({integracaoEventAction:"success-message"}),dataLayer.push({event:"gaSendIntegracao"})),e.data.errors&&(a("errKosmos",!0),t=e.data.errors,dataLayer.push({integracaoEventAction:"success-errors"}),dataLayer.push({event:"gaSendIntegracao"})),e.data.contrato&&(a("errKosmos",!1),a("linkContrato",e.data.contrato),a("linkBoleto",e.data.pagamento[0].boleto),dataLayer.push({integracaoEventAction:"success-contrato-boleto"}),dataLayer.push({event:"gaSendIntegracao"}))):(a("errKosmos",!0),t="kosmos não retornou dados",dataLayer.push({integracaoEventAction:"success-null"}),dataLayer.push({event:"gaSendIntegracao"})),c(n,t)},error:function(e){a("errKosmos",!0),n.requestTime=(new Date).getTime()-i,console.log(e);try{var t=JSON.parse(e.responseText);t&&t.error&&(~t.error.indexOf("pedido já foi enviado")?(a("errKosmos","pedidoEnviado"),dataLayer.push({integracaoEventAction:"error-pedido-ja-enviado"}),dataLayer.push({event:"gaSendIntegracao"})):(dataLayer.push({integracaoEventAction:"error-erro-desconhecido"}),dataLayer.push({event:"gaSendIntegracao"})))}catch(t){e.responseText="Erro ao enviar dados de matrícula ao middleware"+e.status}c(n,e.responseText)}})}())}else console.log("waiting datalayer...")}),100)}))},534:function(e,t,a){}});