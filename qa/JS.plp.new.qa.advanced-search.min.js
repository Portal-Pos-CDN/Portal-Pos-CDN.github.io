/* PC-QUARTO - 26/10/2020 16:53:58 GMT */
"use strict";"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});"function"!=typeof String.prototype.capitalize&&(String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1).toLowerCase()});"function"!==typeof String.prototype.replaceSpecialChars&&(String.prototype.replaceSpecialChars=function(){var b={"ç":"c","æ":"ae","œ":"oe","á":"a","é":"e","í":"i","ó":"o","ú":"u","à":"a","è":"e","ì":"i","ò":"o","ù":"u","ä":"a","ë":"e","ï":"i","ö":"o","ü":"u","ÿ":"y","â":"a","ê":"e","î":"i","ô":"o","û":"u","å":"a","ã":"a","ø":"o","õ":"o",u:"u","Á":"A","É":"E","Í":"I","Ó":"O","Ú":"U","Ê":"E","Ô":"O","Ü":"U","Ã":"A","Õ":"O","À":"A","Ç":"C"};return this.replace(/[\u00e0-\u00fa]/gi,function(a){return"undefined"!=typeof b[a]?b[a]:a})});Array.prototype.indexOf||(Array.prototype.indexOf=function(d,e){var a;if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),b=c.length>>>0;if(0===b)return-1;a=+e||0;Infinity===Math.abs(a)&&(a=0);if(a>=b)return-1;for(a=Math.max(0<=a?a:b-Math.abs(a),0);a<b;){if(a in c&&c[a]===d)return a;a++}return-1});(function(){var _this=this;try{var AdvancedSearch={init:function init(){AdvancedSearch.applySelect2();AdvancedSearch.onSubmitClick();$(window).on("brandLoaded",function(){AdvancedSearch.loadLocations()})},ajaxStop:function ajaxStop(){},windowOnload:function windowOnload(){},onSubmitClick:function onSubmitClick(){$(".MZadvancedSearch--btnSearch").click(function(){AdvancedSearch.onSubmit()})},applySelect2:function applySelect2(){if(!$.fn.select2){return}var wrapper=$(".MZadvancedSearch");wrapper.find('select[name="location"]').select2({placeholder:"Estado, Cidade ou Bairro"});wrapper.find('select[name="modality"]').select2({placeholder:"Modalidade",minimumResultsForSearch:-1,data:[{id:"",text:""}]});wrapper.find('select[name="course"]').select2({placeholder:"Escolha o Curso",data:[{id:"",text:""}]});wrapper.find('select[name="location"]').prop("disabled",true);wrapper.find('select[name="modality"]').prop("disabled",true);wrapper.find('select[name="course"]').prop("disabled",true);wrapper.find('select[name="location"]').on("select2:select",AdvancedSearch.onSelectLocation.bind(_this));wrapper.find('select[name="modality"]').on("select2:select",AdvancedSearch.onSelectModality.bind(_this))},facetsToArray:function facetsToArray(object,field){var fieldItems=Object.keys(object.filter(function(item){if(item.field==field)return item})[0].facets);fieldItems=fieldItems.filter(function(item,index){if(item)return item});fieldItems.unshift("");fieldItems.sort();return fieldItems.map(function(item,index){if(item==""){return{id:"",text:""}}return{id:field+"---"+item,text:item}})},getModalityLabel:function getModalityLabel(modality){switch(modality){case"EDUCAÇÃO A DISTÂNCIA":return"EAD";case"EAD 10 MESES":return"EAD";case"PRESENCIAL":return"PRESENCIAL";case"EAD 6 MESES":return"INTENSIVO";case"SEMIPRESENCIAL":return"SEMI_PRESENCIAL"}},getVTEXModality:function getVTEXModality(modality){switch(modality){case"EDUCAÇÃO A DISTÂNCIA":return"Educação a distância";case"EAD 10 MESES":return"EAD - 10 meses";case"PRESENCIAL":return"Presencial";case"EAD 6 MESES":return"EAD - 6 meses";case"SEMI_PRESENCIAL":return"Semi-presencial"}},getBrandIdFromName:function getBrandIdFromName(brandName){var brand=window.storeConfig.brands.filter(function(brand){if(brand.name.replaceSpecialChars().toLowerCase()==brandName.replaceSpecialChars().toLowerCase()){return brand}});if(brand){return brand[0].id}return null},loadLocations:function loadLocations(){var whereClause="";if($.cookie("marcaOrigem")){var brandId=AdvancedSearch.getBrandIdFromName($.cookie("marcaOrigem"));whereClause="?whereClause=";switch($.cookie("marcaOrigem")){case"unopar":whereClause+="(idMarca='".concat(brandId,"')")+" OR (idMarca='19' AND idModalidade != 'PRESENCIAL')";break;case"lfg":whereClause+="(idMarca='".concat(brandId,"')");break;case"anhanguera":whereClause+="(idMarca='".concat(brandId,"' OR idMarca='16')")+" OR (idMarca='19' AND idModalidade != 'PRESENCIAL')";break;case"uniderp":whereClause+="(idMarca='".concat(brandId,"' AND idUnidade='789')")+" OR (idMarca='19' AND idModalidade != 'PRESENCIAL')";break;default:whereClause+="(idMarca='".concat(brandId,"' OR (idMarca='1' AND idModalidade != 'PRESENCIAL') OR (idMarca='19' AND idModalidade != 'PRESENCIAL') )")}}var url=window.storeConfig.middleware.url+"/ofertas/localidades/"+whereClause;$.ajax({url:encodeURI(url),type:"GET",dataType:"json",success:function success(result){$('.MZadvancedSearch--select select[name="location"]').empty().trigger("change");$('.MZadvancedSearch--select select[name="location"]').select2({placeholder:"Estado, Cidade ou Bairro",matcher:AdvancedSearch.select2.matchStart,data:[{text:"Código UF",children:AdvancedSearch.facetsToArray(result,"codUF")},{text:"Estado",children:AdvancedSearch.facetsToArray(result,"nomeUF")},{text:"Cidade",children:AdvancedSearch.facetsToArray(result,"cidade")},{text:"Bairro",children:AdvancedSearch.facetsToArray(result,"bairro")}]});$('.MZadvancedSearch--select select[name="location"]').prop("disabled",false);AdvancedSearch.isLoading=false;$(window).trigger("mzSelectLocationLoaded",[])},error:function error(e){$('.MZadvancedSearch--select select[name="location"]').val("Erro ao buscar localizações");console.error("Error while get locations >",e);AdvancedSearch.isLoading=false}})},onSelectLocation:function onSelectLocation(event){AdvancedSearch.isLoading=true;var locationName=event.params.data.text;var locationType=event.params.data.id.split("---")[0];var whereClause="whereClause=";if(!$.cookie("marcaOrigem")){whereClause+="".concat(locationType,'="').concat(locationName,'"')}else{var brandId=AdvancedSearch.getBrandIdFromName($.cookie("marcaOrigem"));switch($.cookie("marcaOrigem")){case"unopar":whereClause+="(idMarca='".concat(brandId,"' AND ").concat(locationType,'="').concat(locationName,'")')+" OR (idMarca='19' AND idModalidade != 'PRESENCIAL' AND ".concat(locationType,'="').concat(locationName,'")');break;case"lfg":whereClause+="(idMarca='".concat(brandId,"' AND ").concat(locationType,'="').concat(locationName,'")');break;case"anhanguera":whereClause+="(idMarca='".concat(brandId,"' AND ").concat(locationType,'="').concat(locationName,'") ')+" OR (idMarca='16' AND idModalidade != 'PRESENCIAL' AND ".concat(locationType,'="').concat(locationName,'")')+" OR (idMarca='19' AND idModalidade != 'PRESENCIAL' AND ".concat(locationType,'="').concat(locationName,'")');break;case"uniderp":whereClause+="(idMarca='".concat(brandId,"' AND idUnidade='789' AND ").concat(locationType,'="').concat(locationName,'")')+" OR (idMarca='19' AND idModalidade != 'PRESENCIAL' AND ".concat(locationType,'="').concat(locationName,'")');break;default:whereClause+="(idMarca='".concat(brandId,"' AND ").concat(locationType,'="').concat(locationName,'")')+" OR (idMarca='1' AND idModalidade != 'PRESENCIAL' AND ".concat(locationType,'="').concat(locationName,'")')+" OR (idMarca='19' AND idModalidade != 'PRESENCIAL' AND ".concat(locationType,'="').concat(locationName,'")')}}$.ajax({url:window.storeConfig.middleware.url+"/ofertas/modalidades/?"+whereClause,type:"GET",dataType:"json",success:function success(result){$('.MZadvancedSearch--select select[name="modality"]').empty().trigger("change");$('.MZadvancedSearch--select select[name="course"]').empty().trigger("change");$('.MZadvancedSearch--select select[name="course"]').prop("disabled",true);$('.MZadvancedSearch--select select[name="modality"]').prop("disabled",true);$('.MZadvancedSearch--select select[name="modality"]').select2({placeholder:"Todas as Modalidades",minimumResultsForSearch:-1,data:AdvancedSearch.facetsToArray(result,"idModalidade").map(function(item){if(~window.location.search.indexOf("superbusca")){switch(item.text){case"EAD":return"EDUCAÇÃO A DISTÂNCIA";case"PRESENCIAL":return"PRESENCIAL";case"INTENSIVO":return"EAD 6 MESES";case"SEMI_PRESENCIAL":return"SEMIPRESENCIAL";default:return item.text}}switch(item.text){case"EAD":return"EAD 10 MESES";case"PRESENCIAL":return"PRESENCIAL";case"INTENSIVO":return"EAD 6 MESES";case"SEMI_PRESENCIAL":return"SEMIPRESENCIAL";default:return item.text}})});$('.MZadvancedSearch--select select[name="modality"]').prop("disabled",false);AdvancedSearch.isLoading=false;AdvancedSearch.getCourses(whereClause)},error:function error(e){$('.MZadvancedSearch--select select[name="modality"]').val("Erro ao buscar localizações");console.error("Error while get modalities >",e);AdvancedSearch.isLoading=false}})},onSelectModality:function onSelectModality(event){AdvancedSearch.isLoading=true;var modality=AdvancedSearch.getModalityLabel(event.params.data.text);var locationName=$('.MZadvancedSearch--select select[name="location"]').select2("data")[0].text;var locationType=$('.MZadvancedSearch--select select[name="location"]').select2("data")[0].id.split("---")[0];var whereClause="whereClause=";if(!$.cookie("marcaOrigem")){whereClause+="".concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"'")}else{var brandId=AdvancedSearch.getBrandIdFromName($.cookie("marcaOrigem"));switch($.cookie("marcaOrigem")){case"unopar":whereClause+="(idMarca='".concat(brandId,"' AND ").concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"')")+" OR (idMarca='19' AND ".concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"' AND idModalidade != 'PRESENCIAL')");break;case"lfg":whereClause+="(idMarca='".concat(brandId,"' AND ").concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"')");break;case"anhanguera":whereClause+="(idMarca='".concat(brandId,"' AND ").concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"')")+" OR (idMarca='16' AND ".concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"' AND idModalidade != 'PRESENCIAL')")+" OR (idMarca='19' AND ".concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"' AND idModalidade != 'PRESENCIAL')");break;case"uniderp":whereClause+="(idMarca='".concat(brandId,"' AND idUnidade='789' AND ").concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"')")+" OR (idMarca='19' AND ".concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"' AND idModalidade != 'PRESENCIAL')");break;default:whereClause+="(idMarca='".concat(brandId,"' AND ").concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"')")+" OR (idMarca='1' AND ".concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"' AND idModalidade != 'PRESENCIAL')")+" OR (idMarca='19' AND ".concat(locationType,'="').concat(locationName,"\" AND idModalidade = '").concat(modality,"' AND idModalidade != 'PRESENCIAL')")}}AdvancedSearch.getCourses(whereClause)},getCourses:function getCourses(whereClause){AdvancedSearch.isLoading=true;$.ajax({url:window.storeConfig.middleware.url+"/ofertas/cursos/?"+whereClause,type:"GET",dataType:"json",success:function success(result){$('.MZadvancedSearch--select select[name="course"]').empty().trigger("change");$('.MZadvancedSearch--select select[name="course"]').prop("disabled",true);$('.MZadvancedSearch--select select[name="course"]').select2({placeholder:"Todos os Cursos",matcher:AdvancedSearch.select2.matchCustom,data:AdvancedSearch.facetsToArray(result,"nomeCurso")});$('.MZadvancedSearch--select select[name="course"]').removeClass("loading");$('.MZadvancedSearch--select select[name="course"]').prop("disabled",false);AdvancedSearch.isLoading=false},error:function error(e){$('.MZadvancedSearch--select select[name="course"]').val("Erro ao buscar localizações");console.error("Error while get modalities >",e);AdvancedSearch.isLoading=false}})},getSpecificationParamByName:function getSpecificationParamByName(name){var productFields=window.storeConfig.productFields;if(productFields[name.toLowerCase()]){return"specificationFilter_"+productFields[name.toLowerCase()]}else{console.error("Unrecognized productFields name");return name}},getRedirectUrl:function getRedirectUrl(locationType,locationName,modality,course){var paths=[];var mapParams=[];var url="";paths.push("cursos");mapParams.push("c");if($("body").hasClass("marca-lfg")){paths.push("lfg");mapParams.push("b")}paths.push(locationName);mapParams.push(AdvancedSearch.getSpecificationParamByName(locationType));if(modality){paths.push(modality);mapParams.push(AdvancedSearch.getSpecificationParamByName("Modalidade"))}if(course){paths.push(course);mapParams.push(AdvancedSearch.getSpecificationParamByName("Nome Curso"))}if($.cookie("marcaOrigem")&&!$("body").hasClass("marca-lfg")&&$.cookie("marcaOrigem")!=="anhanguera"&&$.cookie("marcaOrigem")!=="uniderp"){var collectionId=window.linksMenuHeader[$.cookie("marcaOrigem")].split("?O=")[0];paths.push(collectionId);mapParams.push("productClusterSearchableIds")}url=paths.join("/")+"/?map="+mapParams.join(",");url+="&homeSearch=true";url+="&O=OrderByNameASC";return url},redirect:function redirect(url){if($("body").hasClass("marca")){$.ajax({url:encodeURI("/api/catalog_system/pub/products/search/"+url),type:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},complete:function complete(jqXHR,textStatus){var data=JSON.parse(jqXHR.responseText);if(data.length==1&&textStatus=="success"){window.location=encodeURI(location.origin+"/"+data[0].linkText+"/p")}else{window.location=encodeURI(location.origin+"/"+url)}}})}else{window.location=encodeURI(location.origin+"/"+url)}},onSubmit:function onSubmit(){var locationName=$('.MZadvancedSearch select[name="location"]').select2("data")[0].text;var locationType=$('.MZadvancedSearch select[name="location"]').select2("data")[0].id.split("---")[0];var modality=AdvancedSearch.getVTEXModality($('.MZadvancedSearch select[name="modality"]').select2("data")[0].text);var course=$('.MZadvancedSearch select[name="course"]').select2("data")[0].text;if(!locationName){return}try{window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"generic",category:"Formulario",action:"formularioBuscaHome",label:[{tipoLocalidade:locationType,localidade:locationName,modalidade:modality,curso:course}]});window.dataLayer.push({formularioBuscaHome:[{tipoLocalidade:locationType,localidade:locationName,modalidade:modality,curso:course}]})}catch(e){console.log("Push dataLayer error")}var url=AdvancedSearch.getRedirectUrl(locationType,locationName,modality,course);console.log("url",url);window.storeHelpers.generic.setSearchLocation(locationType,locationName);window.storeHelpers.generic.setAdvancedSearchResult(locationName,modality||"Todas as modalidades",course||"Todas os cursos");AdvancedSearch.redirect(url)},select2:{matchStart:function matchStart(params,data){if($.trim(params.term)===""){return data}if(typeof data.children==="undefined"){return null}var filteredChildren=[];var searchTerm=params.term.replaceSpecialChars().toUpperCase();$.each(data.children,function(idx,child){var childText=child.text.replaceSpecialChars().toUpperCase();if(childText.toUpperCase().indexOf(searchTerm.toUpperCase())==0){filteredChildren.push(child)}});if(filteredChildren.length){var modifiedData=$.extend({},data,true);modifiedData.children=filteredChildren;return modifiedData}return null},matchCustom:function matchCustom(params,data){if($.trim(params.term)===""){return data}if(typeof data.text==="undefined"){return null}var searchTerm=params.term.replaceSpecialChars().toUpperCase();var dataText=data.text.replaceSpecialChars().toUpperCase();if(dataText.indexOf(searchTerm)>-1){var modifiedData=$.extend({},data,true);return modifiedData}return null}},data:{isLoading:false}};AdvancedSearch.init()}catch(e){console.log("Erro na instancia [AdvancedSearch]: ",e)}})();